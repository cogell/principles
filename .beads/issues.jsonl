{"id":"principles-19j","title":"Presence duplicates on refresh; ensure unique client session","description":"Acceptance criteria:\\n- Refreshing the page does not create duplicate presence entries for the same user/session.\\n- Presence list shows a single entry per active client session after reloads.\\n- Reconnects replace/refresh the existing entry rather than adding a new one.\\n\\nSuspected cause:\\n- Presence is keyed by a new session/client id on refresh and old entries are not being cleared or deduped on reconnect.","status":"in_progress","priority":2,"issue_type":"bug","created_at":"2025-12-22T10:53:02.696554-05:00","updated_at":"2025-12-22T11:41:49.090502-05:00"}
{"id":"principles-2vh","title":"Combine name and context/tension cards in edit principle view","description":"Combine the two data-definition cards in the principle edit view into a single card. The name card and the context/tension card should be merged; metadata and presence cards remain separate.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T12:01:15.549393-05:00","updated_at":"2025-12-22T12:08:36.478749-05:00","closed_at":"2025-12-22T12:08:36.478749-05:00","close_reason":"Completed"}
{"id":"principles-3gk","title":"Remove seed fields from frontend + backend","description":"Remove seed/principle classification (is_seed, seed_expires_at) across shared types, API, PartyKit Yjs defaults/metadata sync, and client UI. Fully drop the columns in D1 (migration) and update the base schema. Update any copy that references seeds. Ensure legacy Yjs fields are ignored without errors.\n\nScope/plan:\n- Update shared types: remove fields from PrincipleMetadata, PrincipleListItem, PrincipleField.\n- API: remove seed fields from SELECTs/INSERT/PATCH body + SQL.\n- PartyKit: remove seed defaults + metadata PATCH payload; ignore legacy Yjs fields.\n- Client: remove seed badge + seed controls; update list copy.\n- DB: add migration to drop columns (table rebuild) + update 0001_create_principles.sql.","acceptance_criteria":"- API list/detail/metadata responses omit seed fields; PATCH does not accept/write them.\n- PartyKit does not read/write seed fields into Yjs or metadata.\n- UI has no seed badge or seed controls; copy no longer references seeds.\n- TypeScript has no references to is_seed/seed_expires_at in app code.\n- Migration removes columns; fresh schema has no seed fields.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-22T10:56:11.923674-05:00","updated_at":"2025-12-22T11:08:49.797502-05:00"}
{"id":"principles-4wr","title":"Add relative updated_at display helper","description":"Create a shared helper to derive relative time (e.g. \"3h ago\", \"2 days ago\") from ISO timestamps and use it in principle list/detail updated display. Ensure formatting is consistent and handles invalid/missing values gracefully.\n\nScope/plan:\n- Add a utility (shared or client) to format relative time from ISO timestamps.\n- Update list UI to use relative time for updated/created displays.\n- Add unit tests if testing utilities exist; otherwise validate in UI.","acceptance_criteria":"- Relative time helper exists and handles invalid input safely.\n- Updated/created displays use the new relative format.\n- No direct date formatting remains in list/detail components.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T12:02:01.48559-05:00","updated_at":"2025-12-22T12:09:25.449273-05:00","closed_at":"2025-12-22T12:09:25.449273-05:00","close_reason":"Completed"}
{"id":"principles-5y2","title":"Remove seed expires field from frontend/backend","description":"Context\n- The seed expiration date is no longer needed; remove it from UI, realtime doc state, API metadata, and storage.\n\nPlan\n- Frontend: remove seed expiration input and Yjs binding in `packages/client/src/components/PrincipleEditor.tsx`.\n- Shared types: drop `seed_expires_at` from `PrincipleMetadata` and `PrincipleField` in `packages/shared/src/types.ts`.\n- PartyKit: stop seeding/persisting `seed_expires_at` in `packages/partykit/src/principle.ts`.\n- API: remove `seed_expires_at` from selects and metadata PATCH in `packages/api/src/routes/principles.ts`.\n- DB: add a migration to drop the column (or rebuild table if D1/SQLite drop-column is unsupported).\n- Docs: update `plans/collab-docs.md` to remove references.\n\nAcceptance\n- No \"Seed expires\" field appears in the editor UI.\n- API responses and metadata sync omit `seed_expires_at`.\n- PartyKit/Yjs no longer read or write `seed_expires_at`.\n- DB schema no longer includes `seed_expires_at` (migration applied).\n- `rg \"seed_expires_at\"` only hits historical migration/docs, or returns nothing.\n","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-22T10:52:45.609768-05:00","updated_at":"2025-12-22T10:56:43.047621-05:00"}
{"id":"principles-6oi","title":"Configure TypeScript project references","description":"Set up tsconfig.json in each package with project references for proper cross-package type checking and build ordering.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T15:58:05.233511-05:00","updated_at":"2025-12-19T15:58:05.233511-05:00","dependencies":[{"issue_id":"principles-6oi","depends_on_id":"principles-cww","type":"blocks","created_at":"2025-12-19T15:59:31.922765-05:00","created_by":"daemon","metadata":"{}"},{"issue_id":"principles-6oi","depends_on_id":"principles-iey","type":"blocks","created_at":"2025-12-19T15:59:33.448881-05:00","created_by":"daemon","metadata":"{}"},{"issue_id":"principles-6oi","depends_on_id":"principles-y8u","type":"blocks","created_at":"2025-12-19T15:59:34.973497-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":"principles-780","title":"Remove principle status field from frontend + backend","description":"Remove the principle status field (draft/active/deprecated) from shared types/constants, PartyKit Yjs defaults, and the client editor UI. Ensure no status is written/read in Yjs docs and no UI control remains. Clean up any references (types, enums, labels, presence field list).\\n\\nAcceptance: list/editor builds without status references; no status default is inserted by server; existing docs ignore legacy status field.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T10:49:00.451098-05:00","updated_at":"2025-12-22T10:54:07.05853-05:00","closed_at":"2025-12-22T10:54:07.05853-05:00","close_reason":"Removed principle status field from shared types/constants, PartyKit defaults, and client editor UI."}
{"id":"principles-cww","title":"Create @principles/api package","description":"Create Cloudflare Worker package with Hono router, wrangler.toml (D1 + R2 bindings), and placeholder route structure. Depends on @principles/shared.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T15:58:01.618138-05:00","updated_at":"2025-12-19T16:18:21.525335-05:00","closed_at":"2025-12-19T16:18:21.525335-05:00","close_reason":"Created @principles/api with Hono router, D1/R2 bindings, auth middleware, CRUD routes, and Yjs/metadata endpoints. Typecheck verified.","dependencies":[{"issue_id":"principles-cww","depends_on_id":"principles-u9a","type":"blocks","created_at":"2025-12-19T15:59:27.626018-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":"principles-iey","title":"Create @principles/partykit package","description":"Create PartyKit package with partykit.json config. Add yjs and y-partyserver dependencies. Depends on @principles/shared.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T15:58:02.826465-05:00","updated_at":"2025-12-19T16:23:08.991109-05:00","closed_at":"2025-12-19T16:23:08.991109-05:00","close_reason":"Created @principles/partykit with Yjs sync, HTTP proxy to API, auth handling, and persistence callbacks. Typecheck verified.","dependencies":[{"issue_id":"principles-iey","depends_on_id":"principles-u9a","type":"blocks","created_at":"2025-12-19T15:59:28.998963-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":"principles-p9v","title":"Initialize pnpm monorepo with workspace config","description":"Create root package.json with workspace scripts, pnpm-workspace.yaml defining packages/*, and .npmrc with workspace settings (link-workspace-packages, prefer-workspace-packages).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T15:57:40.74806-05:00","updated_at":"2025-12-19T16:07:37.905694-05:00","closed_at":"2025-12-19T16:07:37.905694-05:00","close_reason":"Created package.json, pnpm-workspace.yaml, .npmrc, and packages/ directory. Verified with pnpm install."}
{"id":"principles-rb8","title":"Differentiate buttons from badges in client UI","description":"Adjust styling so buttons (e.g., Back to list) are clearly distinct from badges like the Collaborative draft pill. Update UI components/styles to avoid visual ambiguity between action buttons and labels. Acceptance: buttons have a stronger affordance (contrast, depth, or shape) while badges remain lightweight labels.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T10:57:34.067255-05:00","updated_at":"2025-12-22T11:01:56.805926-05:00","closed_at":"2025-12-22T11:01:56.805926-05:00","close_reason":"Updated button and badge styles so buttons have stronger affordance and badges read as lightweight labels."}
{"id":"principles-u1u","title":"Remove principle confidence field from frontend + backend","description":"Remove the confidence field from shared types/constants, PartyKit Yjs defaults, and the client editor UI. Ensure confidence is no longer written/read in Yjs docs and related UI controls are removed. Clean up references (types, enums, labels, presence field list). Acceptance: build compiles with no confidence references; server does not seed confidence; existing docs ignore legacy confidence field.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T12:00:05.970142-05:00","updated_at":"2025-12-22T12:05:24.713787-05:00","closed_at":"2025-12-22T12:05:24.713787-05:00","close_reason":"Removed confidence field from shared types/constants, PartyKit defaults, and client editor UI."}
{"id":"principles-u9a","title":"Create @principles/shared package","description":"Create shared package with types (Principle, AwarenessState), constants (domains, confidence levels, presence colors), and slug generation utils. Add nanoid dependency.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T15:57:49.919681-05:00","updated_at":"2025-12-19T16:10:42.340333-05:00","closed_at":"2025-12-19T16:10:42.340333-05:00","close_reason":"Created @principles/shared with types (Principle, AwarenessState), constants (domains, confidence, presence colors), and slug utils. Build verified.","dependencies":[{"issue_id":"principles-u9a","depends_on_id":"principles-p9v","type":"blocks","created_at":"2025-12-19T15:59:26.139121-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":"principles-y8u","title":"Create @principles/client package","description":"Create Vite + React SPA with shadcn/ui and react-router. Add yjs, y-indexeddb, partysocket dependencies. Set up environment variables. Depends on @principles/shared.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T15:58:04.023485-05:00","updated_at":"2025-12-19T16:53:34.006181-05:00","closed_at":"2025-12-19T16:53:34.006181-05:00","close_reason":"Created Vite React client with shadcn UI scaffold, routing, env example, and Yjs hooks.","dependencies":[{"issue_id":"principles-y8u","depends_on_id":"principles-u9a","type":"blocks","created_at":"2025-12-19T15:59:30.53036-05:00","created_by":"daemon","metadata":"{}"}]}
